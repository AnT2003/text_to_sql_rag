[{
  "routine_name": "func_get_booking_student_country",
  "routine_definition": "(\n  CASE\n    WHEN country_id \u003d 1 THEN \u0027Thailand\u0027\n    WHEN country_id \u003d 2 THEN \u0027Indo\u0027\n    WHEN country_id \u003d 3 THEN \u0027Việt Nam\u0027\n    WHEN country_id \u003d 4 THEN \u0027Other Countries\u0027\n    WHEN country_id \u003d 5 THEN \u0027Lào\u0027\n    WHEN country_id \u003d 6 THEN \u0027Malaysia\u0027\n  END\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_student_country(country_id INT64)\nAS (\n(\n  CASE\n    WHEN country_id \u003d 1 THEN \u0027Thailand\u0027\n    WHEN country_id \u003d 2 THEN \u0027Indo\u0027\n    WHEN country_id \u003d 3 THEN \u0027Việt Nam\u0027\n    WHEN country_id \u003d 4 THEN \u0027Other Countries\u0027\n    WHEN country_id \u003d 5 THEN \u0027Lào\u0027\n    WHEN country_id \u003d 6 THEN \u0027Malaysia\u0027\n  END\n  )\n);",
  "arguments": "country_id (INT64)"
}, {
  "routine_name": "func_get_teacher_type",
  "routine_definition": "CASE\n    WHEN teacher_type \u003d 1  THEN \u0027100% PHIL\u0027\n  WHEN teacher_type \u003d 2  THEN \u0027100% NATIVE\u0027\n  WHEN teacher_type \u003d 3  THEN \u00272 PHIL/1 VN\u0027\n  WHEN teacher_type \u003d 4  THEN \u00272 NATIVE/1 VN\u0027\n  WHEN teacher_type \u003d 5  THEN \u0027100% VN\u0027\n  WHEN teacher_type \u003d 6  THEN \u0027100% THAILAND\u0027\n  WHEN teacher_type \u003d 7  THEN \u0027CUSTOM\u0027\n  WHEN teacher_type \u003d 8  THEN \u0027100% INDONESIA\u0027\n  WHEN teacher_type \u003d 9  THEN \u00271 PHIL/1 VN\u0027\n  WHEN teacher_type \u003d 10 THEN \u0027NATIVE/1 VN\u0027\n  WHEN teacher_type \u003d 11 THEN \u0027NATIVE/1 PHIL\u0027\n  WHEN teacher_type \u003d 12 THEN \u0027PHIL/1 NATIVE\u0027\n  WHEN teacher_type \u003d 13 THEN \u0027NATIVE/1 PHIL\u0027\n  WHEN teacher_type \u003d 14 THEN \u0027VN/1 PHIL\u0027\n  WHEN teacher_type \u003d 15 THEN \u0027VN/1 NATIVE\u0027\n  WHEN teacher_type \u003d 16 THEN \u0027PHIL/1 THAI\u0027\n  WHEN teacher_type \u003d 17 THEN \u0027NATIVE/1 THAI\u0027\n  WHEN teacher_type \u003d 18 THEN \u0027PHIL/1 THAI\u0027\n  WHEN teacher_type \u003d 19 THEN \u0027NATIVE/1 THAI\u0027\n  WHEN teacher_type \u003d 20 THEN \u0027PHIL/1 INDO\u0027\n  WHEN teacher_type \u003d 21 THEN \u0027NATIVE/1 INDO\u0027\n  WHEN teacher_type \u003d 22 THEN \u0027PHIL/1 INDO\u0027\n  WHEN teacher_type \u003d 23 THEN \u0027NATIVE/1 INDO\u0027\n  WHEN teacher_type \u003d 24 THEN \u0027100% LAOS\u0027\n  WHEN teacher_type \u003d 25 THEN \u0027PHIL/1 LAOS\u0027\n  WHEN teacher_type \u003d 26 THEN \u0027NATIVE/1 LAOS\u0027\n  WHEN teacher_type \u003d 27 THEN \u0027PHIL/1 LAOS\u0027\n  WHEN teacher_type \u003d 28 THEN \u0027NATIVE/1 LAOS\u0027\n  WHEN teacher_type \u003d 29 THEN \u0027100% MALAYSIA\u0027\n  WHEN teacher_type \u003d 30 THEN \u0027PHIL/1 MALAY\u0027\n  WHEN teacher_type \u003d 31 THEN \u0027NATIVE/1 MALAY\u0027\n  WHEN teacher_type \u003d 32 THEN \u0027PHIL/1 MALAY\u0027\n  WHEN teacher_type \u003d 33 THEN \u0027NATIVE/1 MALAY\u0027\n  ELSE \u0027Null\u0027\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_teacher_type(teacher_type INT64)\nAS (\nCASE\n    WHEN teacher_type \u003d 1  THEN \u0027100% PHIL\u0027\n  WHEN teacher_type \u003d 2  THEN \u0027100% NATIVE\u0027\n  WHEN teacher_type \u003d 3  THEN \u00272 PHIL/1 VN\u0027\n  WHEN teacher_type \u003d 4  THEN \u00272 NATIVE/1 VN\u0027\n  WHEN teacher_type \u003d 5  THEN \u0027100% VN\u0027\n  WHEN teacher_type \u003d 6  THEN \u0027100% THAILAND\u0027\n  WHEN teacher_type \u003d 7  THEN \u0027CUSTOM\u0027\n  WHEN teacher_type \u003d 8  THEN \u0027100% INDONESIA\u0027\n  WHEN teacher_type \u003d 9  THEN \u00271 PHIL/1 VN\u0027\n  WHEN teacher_type \u003d 10 THEN \u0027NATIVE/1 VN\u0027\n  WHEN teacher_type \u003d 11 THEN \u0027NATIVE/1 PHIL\u0027\n  WHEN teacher_type \u003d 12 THEN \u0027PHIL/1 NATIVE\u0027\n  WHEN teacher_type \u003d 13 THEN \u0027NATIVE/1 PHIL\u0027\n  WHEN teacher_type \u003d 14 THEN \u0027VN/1 PHIL\u0027\n  WHEN teacher_type \u003d 15 THEN \u0027VN/1 NATIVE\u0027\n  WHEN teacher_type \u003d 16 THEN \u0027PHIL/1 THAI\u0027\n  WHEN teacher_type \u003d 17 THEN \u0027NATIVE/1 THAI\u0027\n  WHEN teacher_type \u003d 18 THEN \u0027PHIL/1 THAI\u0027\n  WHEN teacher_type \u003d 19 THEN \u0027NATIVE/1 THAI\u0027\n  WHEN teacher_type \u003d 20 THEN \u0027PHIL/1 INDO\u0027\n  WHEN teacher_type \u003d 21 THEN \u0027NATIVE/1 INDO\u0027\n  WHEN teacher_type \u003d 22 THEN \u0027PHIL/1 INDO\u0027\n  WHEN teacher_type \u003d 23 THEN \u0027NATIVE/1 INDO\u0027\n  WHEN teacher_type \u003d 24 THEN \u0027100% LAOS\u0027\n  WHEN teacher_type \u003d 25 THEN \u0027PHIL/1 LAOS\u0027\n  WHEN teacher_type \u003d 26 THEN \u0027NATIVE/1 LAOS\u0027\n  WHEN teacher_type \u003d 27 THEN \u0027PHIL/1 LAOS\u0027\n  WHEN teacher_type \u003d 28 THEN \u0027NATIVE/1 LAOS\u0027\n  WHEN teacher_type \u003d 29 THEN \u0027100% MALAYSIA\u0027\n  WHEN teacher_type \u003d 30 THEN \u0027PHIL/1 MALAY\u0027\n  WHEN teacher_type \u003d 31 THEN \u0027NATIVE/1 MALAY\u0027\n  WHEN teacher_type \u003d 32 THEN \u0027PHIL/1 MALAY\u0027\n  WHEN teacher_type \u003d 33 THEN \u0027NATIVE/1 MALAY\u0027\n  ELSE \u0027Null\u0027\n  END\n);",
  "arguments": "teacher_type (INT64)"
}, {
  "routine_name": "func_get_student_phone_number",
  "routine_definition": "(\r\nselect u1.phone_number \r\n         from `kynaforkids.user` u1 \r\n         inner join `kynaforkids.user` u2 on u1.id \u003d u2.parent_id\r\n         where u2.id \u003d student_id\r\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_student_phone_number(student_id INT64)\nAS (\n(\r\nselect u1.phone_number \r\n         from `kynaforkids.user` u1 \r\n         inner join `kynaforkids.user` u2 on u1.id \u003d u2.parent_id\r\n         where u2.id \u003d student_id\r\n  )\n);",
  "arguments": "student_id (INT64)"
}, {
  "routine_name": "func_get_program_name_from_id",
  "routine_definition": "(\n    SELECT\n      bp.name\n    FROM\n      `kynaforkids-server-production.kynaforkids.booking_program` bp\n    WHERE\n      bp.id\u003dprogram_id\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_program_name_from_id(program_id INT64)\nAS (\n(\n    SELECT\n      bp.name\n    FROM\n      `kynaforkids-server-production.kynaforkids.booking_program` bp\n    WHERE\n      bp.id\u003dprogram_id\n  )\n);",
  "arguments": "program_id (INT64)"
}, {
  "routine_name": "func_get_country_teacher",
  "routine_definition": "CASE\r\n      WHEN country_id \u003d 1 THEN \u0027Philippines\u0027\r\n      WHEN country_id \u003d 2 THEN \u0027Native\u0027\r\n      WHEN country_id \u003d 3 THEN \u0027Vietnamese\u0027\r\n      WHEN country_id \u003d 4 THEN \u0027Thailand\u0027\r\n      WHEN country_id \u003d 5 THEN \u0027Indonesia\u0027\r\n      WHEN country_id \u003d 8 THEN \u0027Laos\u0027\r\n      WHEN country_id \u003d 9 THEN \u0027Malaysia\u0027\r\n    ELSE\r\n    \u0027Other countries\u0027\r\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_country_teacher(country_id INT64)\nAS (\nCASE\r\n      WHEN country_id \u003d 1 THEN \u0027Philippines\u0027\r\n      WHEN country_id \u003d 2 THEN \u0027Native\u0027\r\n      WHEN country_id \u003d 3 THEN \u0027Vietnamese\u0027\r\n      WHEN country_id \u003d 4 THEN \u0027Thailand\u0027\r\n      WHEN country_id \u003d 5 THEN \u0027Indonesia\u0027\r\n      WHEN country_id \u003d 8 THEN \u0027Laos\u0027\r\n      WHEN country_id \u003d 9 THEN \u0027Malaysia\u0027\r\n    ELSE\r\n    \u0027Other countries\u0027\r\n  END\n);",
  "arguments": "country_id (INT64)"
}, {
  "routine_name": "func_get_booking_lead_action_name",
  "routine_definition": "CASE action\r\n        WHEN 1 THEN \u0027Thêm ghi chú\u0027\r\n        WHEN 2 THEN \u0027Cập nhật trạng thái liên hệ\u0027\r\n        WHEN 3 THEN \u0027Nhập điểm đầu vào\u0027\r\n        WHEN 4 THEN \u0027Chuyển Sale follow\u0027\r\n        WHEN 5 THEN \u0027Tạo lead\u0027\r\n        WHEN 6 THEN \u0027Cập nhật Lead\u0027\r\n        WHEN 7 THEN \u0027Nhập Lead từ File\u0027\r\n        WHEN 8 THEN \u0027Hoàn thành THAI Lead\u0027\r\n        WHEN 9 THEN \u0027Huỷ THAI Lead\u0027\r\n        WHEN 10 THEN \u0027Chuyển qua giao vận\u0027\r\n        WHEN 11 THEN \u0027Hủy giao vận\u0027\r\n        WHEN 12 THEN \u0027Cập nhật trạng thái giao vận\u0027\r\n        WHEN 13 THEN \u0027Gọi điện thoại\u0027\r\n        WHEN 14 THEN \u0027Gắn nhãn\u0027\r\n        ELSE \u0027Unknown\u0027\r\n    END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_lead_action_name(action INT64) RETURNS STRING\nAS (\nCASE action\r\n        WHEN 1 THEN \u0027Thêm ghi chú\u0027\r\n        WHEN 2 THEN \u0027Cập nhật trạng thái liên hệ\u0027\r\n        WHEN 3 THEN \u0027Nhập điểm đầu vào\u0027\r\n        WHEN 4 THEN \u0027Chuyển Sale follow\u0027\r\n        WHEN 5 THEN \u0027Tạo lead\u0027\r\n        WHEN 6 THEN \u0027Cập nhật Lead\u0027\r\n        WHEN 7 THEN \u0027Nhập Lead từ File\u0027\r\n        WHEN 8 THEN \u0027Hoàn thành THAI Lead\u0027\r\n        WHEN 9 THEN \u0027Huỷ THAI Lead\u0027\r\n        WHEN 10 THEN \u0027Chuyển qua giao vận\u0027\r\n        WHEN 11 THEN \u0027Hủy giao vận\u0027\r\n        WHEN 12 THEN \u0027Cập nhật trạng thái giao vận\u0027\r\n        WHEN 13 THEN \u0027Gọi điện thoại\u0027\r\n        WHEN 14 THEN \u0027Gắn nhãn\u0027\r\n        ELSE \u0027Unknown\u0027\r\n    END\n);",
  "arguments": "action (INT64)"
}, {
  "routine_name": "func_get_status_teacher",
  "routine_definition": "CASE\n  WHEN status \u003d 0 THEN \u0027Deactive\u0027\n  WHEN status \u003d 1 THEN \u0027Active\u0027\nEND",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_status_teacher(status INT64)\nAS (\nCASE\n  WHEN status \u003d 0 THEN \u0027Deactive\u0027\n  WHEN status \u003d 1 THEN \u0027Active\u0027\nEND\n);",
  "arguments": "status (INT64)"
}, {
  "routine_name": "func_get_source",
  "routine_definition": "CASE\r\n  WHEN source \u003d 1 THEN \u0027Marketing\u0027\r\n  WHEN source \u003d 2 THEN \u0027Sales\u0027\r\n  WHEN source \u003d 3 THEN \u0027Business development\u0027\r\n  WHEN source \u003d 4 THEN \u0027Other data\u0027\r\n  WHEN source \u003d 6 THEN \u0027LP 1 kèm 1 Visitor\u0027\r\n  WHEN source \u003d 7 THEN \u0027LP 1 kèm 1 Visitor - Khác\u0027\r\n  ELSE NULL\r\nEND",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_source(source INT64)\nAS (\nCASE\r\n  WHEN source \u003d 1 THEN \u0027Marketing\u0027\r\n  WHEN source \u003d 2 THEN \u0027Sales\u0027\r\n  WHEN source \u003d 3 THEN \u0027Business development\u0027\r\n  WHEN source \u003d 4 THEN \u0027Other data\u0027\r\n  WHEN source \u003d 6 THEN \u0027LP 1 kèm 1 Visitor\u0027\r\n  WHEN source \u003d 7 THEN \u0027LP 1 kèm 1 Visitor - Khác\u0027\r\n  ELSE NULL\r\nEND\n);",
  "arguments": "source (INT64)"
}, {
  "routine_name": "func_get_parent_id_from_kynaforkids_user_by_student_id",
  "routine_definition": "(\r\n   SELECT\r\n      u.parent_id\r\n    FROM\r\n    `kynaforkids-server-production.kynaforkids.user` u\r\n    where u.id \u003d student_id\r\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_parent_id_from_kynaforkids_user_by_student_id(student_id INT64)\nAS (\n(\r\n   SELECT\r\n      u.parent_id\r\n    FROM\r\n    `kynaforkids-server-production.kynaforkids.user` u\r\n    where u.id \u003d student_id\r\n  )\n);",
  "arguments": "student_id (INT64)"
}, {
  "routine_name": "func_get_esign",
  "routine_definition": "case\r\n        when status \u003d 0 then \u0027No\u0027\r\n        when status \u003d 1 then \u0027Yes\u0027\r\n   end",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_esign(status INT64)\nAS (\ncase\r\n        when status \u003d 0 then \u0027No\u0027\r\n        when status \u003d 1 then \u0027Yes\u0027\r\n   end\n);",
  "arguments": "status (INT64)"
}, {
  "routine_name": "func_get_type_teacher",
  "routine_definition": "CASE\n  WHEN country_id \u003d 1 THEN \u0027PHILIPPINES\u0027\n  WHEN country_id \u003d 2 THEN \u0027NATIVE\u0027\n  WHEN country_id \u003d 3 THEN \u0027VIETNAMESE\u0027\n  WHEN country_id \u003d 4 THEN \u0027THAILAND\u0027\n  WHEN country_id \u003d 5 THEN \u0027Indonesia\u0027\n  WHEN country_id \u003d 8 THEN \u0027Laos\u0027\n  WHEN country_id \u003d 9 THEN \u0027Malaysia\u0027\nEND",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_type_teacher(country_id INT64)\nAS (\nCASE\n  WHEN country_id \u003d 1 THEN \u0027PHILIPPINES\u0027\n  WHEN country_id \u003d 2 THEN \u0027NATIVE\u0027\n  WHEN country_id \u003d 3 THEN \u0027VIETNAMESE\u0027\n  WHEN country_id \u003d 4 THEN \u0027THAILAND\u0027\n  WHEN country_id \u003d 5 THEN \u0027Indonesia\u0027\n  WHEN country_id \u003d 8 THEN \u0027Laos\u0027\n  WHEN country_id \u003d 9 THEN \u0027Malaysia\u0027\nEND\n);",
  "arguments": "country_id (INT64)"
}, {
  "routine_name": "func_get_booking_lead_status",
  "routine_definition": "CASE\n      WHEN status \u003d 1 THEN \u0027Tạo mới\u0027\n      WHEN status \u003d 2 THEN \u0027Liên hệ - Chưa liên hệ được\u0027\n      WHEN status \u003d 16 THEN \u0027Liên hệ - Gọi lại\u0027\n      WHEN status \u003d 3 THEN \u0027Đang tư vấn\u0027\n      WHEN status \u003d 4 THEN \u0027Mời tham gia test - Văn phòng\u0027\n      WHEN status \u003d 5 THEN \u0027Mời tham gia test - Online\u0027\n      WHEN status \u003d 7 THEN \u0027Đã làm test online\u0027\n      WHEN status \u003d 8 THEN \u0027Gửi lộ trình học và biểu phí\u0027\n      WHEN status \u003d 10 THEN \u0027Học thử\u0027\n      WHEN status \u003d 9 THEN \u0027Từ chối\u0027\n      WHEN status \u003d 11 THEN \u0027Ghi danh\u0027\n      WHEN status \u003d 20 THEN \u0027Ghi danh - Chờ lên đơn\u0027\n      WHEN status \u003d 21 THEN \u0027Chờ thanh toán\u0027\n      WHEN status \u003d 22 THEN \u0027Cọc\u0027\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_lead_status(status INT64)\nAS (\nCASE\n      WHEN status \u003d 1 THEN \u0027Tạo mới\u0027\n      WHEN status \u003d 2 THEN \u0027Liên hệ - Chưa liên hệ được\u0027\n      WHEN status \u003d 16 THEN \u0027Liên hệ - Gọi lại\u0027\n      WHEN status \u003d 3 THEN \u0027Đang tư vấn\u0027\n      WHEN status \u003d 4 THEN \u0027Mời tham gia test - Văn phòng\u0027\n      WHEN status \u003d 5 THEN \u0027Mời tham gia test - Online\u0027\n      WHEN status \u003d 7 THEN \u0027Đã làm test online\u0027\n      WHEN status \u003d 8 THEN \u0027Gửi lộ trình học và biểu phí\u0027\n      WHEN status \u003d 10 THEN \u0027Học thử\u0027\n      WHEN status \u003d 9 THEN \u0027Từ chối\u0027\n      WHEN status \u003d 11 THEN \u0027Ghi danh\u0027\n      WHEN status \u003d 20 THEN \u0027Ghi danh - Chờ lên đơn\u0027\n      WHEN status \u003d 21 THEN \u0027Chờ thanh toán\u0027\n      WHEN status \u003d 22 THEN \u0027Cọc\u0027\n  END\n);",
  "arguments": "status (INT64)"
}, {
  "routine_name": "func_get_booking_payment_content",
  "routine_definition": "CASE\n      WHEN booking_payment_content \u003d 1 THEN \u0027Học thử\u0027\n      WHEN booking_payment_content \u003d 2 THEN \u0027Ghi danh lần đầu\u0027\n      WHEN booking_payment_content \u003d 3 THEN \u0027Trả góp lần sau\u0027\n      WHEN booking_payment_content \u003d 4 THEN \u0027Ghi danh lại\u0027\n      WHEN booking_payment_content \u003d 5 THEN \u0027Điều chỉnh\u0027\n      WHEN booking_payment_content \u003d 6 THEN \u0027Hoàn tiền\u0027\n      WHEN booking_payment_content \u003d 7 THEN \u0027Nâng cấp\u0027\n      WHEN booking_payment_content \u003d 8 THEN \u0027Hạ cấp\u0027\n      WHEN booking_payment_content \u003d 9 then \u0027Đổi chương trình\u0027\n      WHEN booking_payment_content \u003d 10 then \u0027Chuyển nhượng\u0027\n      WHEN booking_payment_content \u003d 14 then \u0027Đảo\u0027\n    ELSE\n    NUll\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_payment_content(booking_payment_content INT64)\nAS (\nCASE\n      WHEN booking_payment_content \u003d 1 THEN \u0027Học thử\u0027\n      WHEN booking_payment_content \u003d 2 THEN \u0027Ghi danh lần đầu\u0027\n      WHEN booking_payment_content \u003d 3 THEN \u0027Trả góp lần sau\u0027\n      WHEN booking_payment_content \u003d 4 THEN \u0027Ghi danh lại\u0027\n      WHEN booking_payment_content \u003d 5 THEN \u0027Điều chỉnh\u0027\n      WHEN booking_payment_content \u003d 6 THEN \u0027Hoàn tiền\u0027\n      WHEN booking_payment_content \u003d 7 THEN \u0027Nâng cấp\u0027\n      WHEN booking_payment_content \u003d 8 THEN \u0027Hạ cấp\u0027\n      WHEN booking_payment_content \u003d 9 then \u0027Đổi chương trình\u0027\n      WHEN booking_payment_content \u003d 10 then \u0027Chuyển nhượng\u0027\n      WHEN booking_payment_content \u003d 14 then \u0027Đảo\u0027\n    ELSE\n    NUll\n  END\n);",
  "arguments": "booking_payment_content (INT64)"
}, {
  "routine_name": "func_get_teacher_source",
  "routine_definition": "CASE\n  WHEN teacher_source \u003d 1 THEN \u0027Nguồn Kyna\u0027\n  WHEN teacher_source \u003d 2 THEN \u0027Nguồn Rarejob\u0027\n  WHEN teacher_source \u003d 3 THEN \u0027Nguồn GGE\u0027\n  WHEN teacher_source \u003d 4 THEN \u0027Nguồn Murpher\u0027\n  WHEN teacher_source \u003d 5 THEN \u0027Back office\u0027\nEND",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_teacher_source(teacher_source INT64)\nAS (\nCASE\n  WHEN teacher_source \u003d 1 THEN \u0027Nguồn Kyna\u0027\n  WHEN teacher_source \u003d 2 THEN \u0027Nguồn Rarejob\u0027\n  WHEN teacher_source \u003d 3 THEN \u0027Nguồn GGE\u0027\n  WHEN teacher_source \u003d 4 THEN \u0027Nguồn Murpher\u0027\n  WHEN teacher_source \u003d 5 THEN \u0027Back office\u0027\nEND\n);",
  "arguments": "teacher_source (INT64)"
}, {
  "routine_name": "func_get_order_type",
  "routine_definition": "CASE\r\n      WHEN order_type \u003d 1 THEN \u0027Đơn hàng mới\u0027\r\n      WHEN order_type \u003d 2 THEN \u0027Đơn hàng điều chỉnh\u0027\r\n      WHEN order_type \u003d 3 THEN \u0027Đơn hàng hoàn tiền\u0027\r\n      WHEN order_type \u003d 4 THEN \u0027Đơn hàng hủy\u0027\r\n      WHEN order_type \u003d 5 THEN \u0027Đơn hàng đảo\u0027\r\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_order_type(order_type INT64)\nAS (\nCASE\r\n      WHEN order_type \u003d 1 THEN \u0027Đơn hàng mới\u0027\r\n      WHEN order_type \u003d 2 THEN \u0027Đơn hàng điều chỉnh\u0027\r\n      WHEN order_type \u003d 3 THEN \u0027Đơn hàng hoàn tiền\u0027\r\n      WHEN order_type \u003d 4 THEN \u0027Đơn hàng hủy\u0027\r\n      WHEN order_type \u003d 5 THEN \u0027Đơn hàng đảo\u0027\r\n  END\n);",
  "arguments": "order_type (INT64)"
}, {
  "routine_name": "func_get_booking_status",
  "routine_definition": "(\r\n  CASE\r\n    WHEN status_id \u003d 1 THEN \u0027Draft\u0027\r\n    WHEN status_id \u003d 2 THEN \u0027New\u0027\r\n    WHEN status_id \u003d 3 THEN \u0027WaitingApprove\u0027\r\n    WHEN status_id \u003d 4 THEN \u0027Approved\u0027\r\n    WHEN status_id \u003d 5 THEN \u0027Completed\u0027\r\n    WHEN status_id \u003d 6 THEN \u0027Rejected\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 1 THEN \u0027Cancelled bởi GV có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 2 THEN \u0027Cancelled by HV Không bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 3 THEN \u0027Cancelled by Kyna có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 4 THEN \u0027Cancelled by HV có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 5 THEN \u0027Cancelled by Kyna Không bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 6 THEN \u0027Cancelled by GV Không bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 7 THEN \u0027Cancelled by Kyna có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 8 THEN \u0027Cancelled by GV có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 9 THEN \u0027Cancelled by Kyna Không bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 10 THEN \u0027Cancelled by Kyna có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 11 THEN \u0027Giáo viên no show có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 12 THEN \u0027Cancelled bởi HV và GV không bù\u0027\r\n    WHEN status_id \u003d 8 THEN \u0027Deleted\u0027\r\n  END\r\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_status(status_id INT64, cancel_config_id INT64)\nAS (\n(\r\n  CASE\r\n    WHEN status_id \u003d 1 THEN \u0027Draft\u0027\r\n    WHEN status_id \u003d 2 THEN \u0027New\u0027\r\n    WHEN status_id \u003d 3 THEN \u0027WaitingApprove\u0027\r\n    WHEN status_id \u003d 4 THEN \u0027Approved\u0027\r\n    WHEN status_id \u003d 5 THEN \u0027Completed\u0027\r\n    WHEN status_id \u003d 6 THEN \u0027Rejected\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 1 THEN \u0027Cancelled bởi GV có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 2 THEN \u0027Cancelled by HV Không bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 3 THEN \u0027Cancelled by Kyna có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 4 THEN \u0027Cancelled by HV có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 5 THEN \u0027Cancelled by Kyna Không bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 6 THEN \u0027Cancelled by GV Không bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 7 THEN \u0027Cancelled by Kyna có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 8 THEN \u0027Cancelled by GV có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 9 THEN \u0027Cancelled by Kyna Không bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 10 THEN \u0027Cancelled by Kyna có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 11 THEN \u0027Giáo viên no show có bù\u0027\r\n    WHEN status_id \u003d 7 AND cancel_config_id \u003d 12 THEN \u0027Cancelled bởi HV và GV không bù\u0027\r\n    WHEN status_id \u003d 8 THEN \u0027Deleted\u0027\r\n  END\r\n  )\n);",
  "arguments": "status_id (INT64), cancel_config_id (INT64)"
}, {
  "routine_name": "func_get_teacher_name",
  "routine_definition": "(\n    SELECT\n      p.name\n    FROM\n      `kynaforkids-server-production.kynaforkids.profile` p\n    WHERE\n      p.user_id\u003dteacher_id LIMIT 1)",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_teacher_name(teacher_id INT64)\nAS (\n(\n    SELECT\n      p.name\n    FROM\n      `kynaforkids-server-production.kynaforkids.profile` p\n    WHERE\n      p.user_id\u003dteacher_id LIMIT 1)\n);",
  "arguments": "teacher_id (INT64)"
}, {
  "routine_name": "func_get_booking_lead_reason_cancel_id",
  "routine_definition": "CASE\n      WHEN reason_cancel_id \u003d 1 THEN \u0027Học phí cao\u0027\n      WHEN reason_cancel_id \u003d 2 THEN \u0027Thời gian buổi học ngắn\u0027\n      WHEN reason_cancel_id \u003d 3 THEN \u0027Ox không đồng ý\u0027\n      WHEN reason_cancel_id \u003d 4 THEN \u0027Bé không thích học Online 1 chổ\u0027\n      WHEN reason_cancel_id \u003d 5 THEN \u0027Đang học ở trung tâm khác\u0027\n      WHEN reason_cancel_id \u003d 6 THEN \u0027Bé \u003c 3 tuổi\u0027\n      WHEN reason_cancel_id \u003d 7 THEN \u0027Bé \u003e18 tuổi\u0027\n      WHEN reason_cancel_id \u003d 8 THEN \u0027Trùng\u0027\n      WHEN reason_cancel_id \u003d 9 THEN \u0027Nhầm số/ Bé nghịch\u0027\n      WHEN reason_cancel_id \u003d 10 THEN \u0027Thuê bao/ KNM trên 5 lần\u0027\n      WHEN reason_cancel_id \u003d 11 THEN \u0027Quan tâm chương trình khác\u0027\n      WHEN reason_cancel_id \u003d 12 THEN \u0027Tìm trung tâm dạy trực tiếp\u0027\n      WHEN reason_cancel_id \u003d 13 THEN \u0027Tham khảo sau\u0027\n      WHEN reason_cancel_id \u003d 13 THEN \u0027Thanh toán thất bại/Hình thức thanh toán không phù hợp\u0027\n    ELSE\n    \u0027Khác\u0027\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_lead_reason_cancel_id(reason_cancel_id INT64)\nAS (\nCASE\n      WHEN reason_cancel_id \u003d 1 THEN \u0027Học phí cao\u0027\n      WHEN reason_cancel_id \u003d 2 THEN \u0027Thời gian buổi học ngắn\u0027\n      WHEN reason_cancel_id \u003d 3 THEN \u0027Ox không đồng ý\u0027\n      WHEN reason_cancel_id \u003d 4 THEN \u0027Bé không thích học Online 1 chổ\u0027\n      WHEN reason_cancel_id \u003d 5 THEN \u0027Đang học ở trung tâm khác\u0027\n      WHEN reason_cancel_id \u003d 6 THEN \u0027Bé \u003c 3 tuổi\u0027\n      WHEN reason_cancel_id \u003d 7 THEN \u0027Bé \u003e18 tuổi\u0027\n      WHEN reason_cancel_id \u003d 8 THEN \u0027Trùng\u0027\n      WHEN reason_cancel_id \u003d 9 THEN \u0027Nhầm số/ Bé nghịch\u0027\n      WHEN reason_cancel_id \u003d 10 THEN \u0027Thuê bao/ KNM trên 5 lần\u0027\n      WHEN reason_cancel_id \u003d 11 THEN \u0027Quan tâm chương trình khác\u0027\n      WHEN reason_cancel_id \u003d 12 THEN \u0027Tìm trung tâm dạy trực tiếp\u0027\n      WHEN reason_cancel_id \u003d 13 THEN \u0027Tham khảo sau\u0027\n      WHEN reason_cancel_id \u003d 13 THEN \u0027Thanh toán thất bại/Hình thức thanh toán không phù hợp\u0027\n    ELSE\n    \u0027Khác\u0027\n  END\n);",
  "arguments": "reason_cancel_id (INT64)"
}, {
  "routine_name": "func_get_sale_in_charge_email",
  "routine_definition": "(\r\n    SELECT \r\n      MAX(u.email)\r\n    FROM `kynaforkids-server-production.kynaforkids.user` u\r\n    WHERE u.id \u003d sale_in_charge_id \r\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_sale_in_charge_email(sale_in_charge_id INT64)\nAS (\n(\r\n    SELECT \r\n      MAX(u.email)\r\n    FROM `kynaforkids-server-production.kynaforkids.user` u\r\n    WHERE u.id \u003d sale_in_charge_id \r\n  )\n);",
  "arguments": "sale_in_charge_id (INT64)"
}, {
  "routine_name": "func_get_affiliate_email",
  "routine_definition": "(\n    SELECT\n      DISTINCT(u.email)\n    FROM\n      `kynaforkids-server-production.kynaforkids.affiliate_user` au,\n      `kynaforkids-server-production.kynaforkids.user` u\n    WHERE\n      au.affiliate_id \u003d affiliate\n      AND au.user_id\u003du.id)",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_affiliate_email(affiliate INT64)\nAS (\n(\n    SELECT\n      DISTINCT(u.email)\n    FROM\n      `kynaforkids-server-production.kynaforkids.affiliate_user` au,\n      `kynaforkids-server-production.kynaforkids.user` u\n    WHERE\n      au.affiliate_id \u003d affiliate\n      AND au.user_id\u003du.id)\n);",
  "arguments": "affiliate (INT64)"
}, {
  "routine_name": "func_get_booking_order_status",
  "routine_definition": "CASE\n      WHEN booking_order_status \u003d 1 THEN \u0027Mới tạo\u0027\n      WHEN booking_order_status \u003d 2 THEN \u0027Đã xem link\u0027\n      WHEN booking_order_status \u003d 4 THEN \u0027Hoàn thành\u0027\n      WHEN booking_order_status \u003d 5 THEN \u0027Thanh toán thất bại\u0027\n      WHEN booking_order_status \u003d 6 THEN \u0027Chờ xác nhận thanh toán\u0027\n      WHEN booking_order_status \u003d 7 THEN \u0027Chờ thanh toán\u0027\n    ELSE\n    \u0027Khác\u0027\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_order_status(booking_order_status INT64)\nAS (\nCASE\n      WHEN booking_order_status \u003d 1 THEN \u0027Mới tạo\u0027\n      WHEN booking_order_status \u003d 2 THEN \u0027Đã xem link\u0027\n      WHEN booking_order_status \u003d 4 THEN \u0027Hoàn thành\u0027\n      WHEN booking_order_status \u003d 5 THEN \u0027Thanh toán thất bại\u0027\n      WHEN booking_order_status \u003d 6 THEN \u0027Chờ xác nhận thanh toán\u0027\n      WHEN booking_order_status \u003d 7 THEN \u0027Chờ thanh toán\u0027\n    ELSE\n    \u0027Khác\u0027\n  END\n);",
  "arguments": "booking_order_status (INT64)"
}, {
  "routine_name": "func_get_source_affiliate",
  "routine_definition": "CASE\r\n  WHEN source \u003d 1 THEN \u0027Marketing\u0027\r\n  WHEN source \u003d 2 THEN \u0027Telemarketing\u0027\r\n  WHEN source \u003d 3 THEN \u0027Customer Referral\u0027\r\n  WHEN source \u003d 4 THEN \u0027Partnership\u0027\r\n  WHEN source \u003d 5 THEN \u0027School\u0027\r\n  WHEN source \u003d 6 THEN \u0027Tự tìm\u0027\r\n  WHEN source \u003d 7 THEN \u0027Khác\u0027\r\n  WHEN source \u003d 8 THEN \u0027CTV giới thiệu CTV\u0027\r\n  WHEN source \u003d 9 THEN \u0027Trang chủ\u0027\r\n  WHEN source \u003d 10 THEN \u0027Sales\u0027\r\n  ELSE NULL\r\nEND",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_source_affiliate(source INT64)\nAS (\nCASE\r\n  WHEN source \u003d 1 THEN \u0027Marketing\u0027\r\n  WHEN source \u003d 2 THEN \u0027Telemarketing\u0027\r\n  WHEN source \u003d 3 THEN \u0027Customer Referral\u0027\r\n  WHEN source \u003d 4 THEN \u0027Partnership\u0027\r\n  WHEN source \u003d 5 THEN \u0027School\u0027\r\n  WHEN source \u003d 6 THEN \u0027Tự tìm\u0027\r\n  WHEN source \u003d 7 THEN \u0027Khác\u0027\r\n  WHEN source \u003d 8 THEN \u0027CTV giới thiệu CTV\u0027\r\n  WHEN source \u003d 9 THEN \u0027Trang chủ\u0027\r\n  WHEN source \u003d 10 THEN \u0027Sales\u0027\r\n  ELSE NULL\r\nEND\n);",
  "arguments": "source (INT64)"
}, {
  "routine_name": "func_get_order_status",
  "routine_definition": "case\n        when status \u003d 1 then \u0027Mới tạo\u0027\n        when status \u003d 2 then \u0027Xác nhận\u0027\n        when status \u003d 3 then \u0027Hoàn thành\u0027\n        when status \u003d 4 then \u0027Hủy\u0027\n   end",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_order_status(status INT64)\nAS (\ncase\n        when status \u003d 1 then \u0027Mới tạo\u0027\n        when status \u003d 2 then \u0027Xác nhận\u0027\n        when status \u003d 3 then \u0027Hoàn thành\u0027\n        when status \u003d 4 then \u0027Hủy\u0027\n   end\n);",
  "arguments": "status (INT64)"
}, {
  "routine_name": "func_get_booking_program",
  "routine_definition": "(\r\n    SELECT\r\n      STRING_AGG (bp.name, \u0027,\u0027)\r\n    FROM\r\n      `kynaforkids-server-production.kynaforkids.booking_program` bp\r\n    WHERE\r\n      bp.id\u003dprogram_id\r\n      )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_program(program_id INT64)\nAS (\n(\r\n    SELECT\r\n      STRING_AGG (bp.name, \u0027,\u0027)\r\n    FROM\r\n      `kynaforkids-server-production.kynaforkids.booking_program` bp\r\n    WHERE\r\n      bp.id\u003dprogram_id\r\n      )\n);",
  "arguments": "program_id (INT64)"
}, {
  "routine_name": "func_get_payment_method_teacher",
  "routine_definition": "CASE\n  WHEN payment_method \u003d 1 then \u0027VN bank\u0027\n  WHEN payment_method \u003d 2 then \u0027Paypal\u0027\n  WHEN payment_method \u003d 3 then \u0027International Bank\u0027\nEND",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_payment_method_teacher(payment_method INT64)\nAS (\nCASE\n  WHEN payment_method \u003d 1 then \u0027VN bank\u0027\n  WHEN payment_method \u003d 2 then \u0027Paypal\u0027\n  WHEN payment_method \u003d 3 then \u0027International Bank\u0027\nEND\n);",
  "arguments": "payment_method (INT64)"
}, {
  "routine_name": "func_get_booking_rating",
  "routine_definition": "CASE\n      WHEN (rating \u003d 0 or rating is null) THEN \u0027Chưa đánh giá\u0027\n      WHEN rating \u003d 1 THEN \u0027Không đạt\u0027\n      WHEN rating \u003d 2 THEN \u0027Đạt\u0027\n      WHEN rating \u003d 3 THEN \u0027Lớp dưới chuẩn\u0027\n      WHEN rating \u003d 4 THEN \u0027Lớp No pay\u0027\n      WHEN rating \u003d 5 THEN \u0027Chưa đủ điều kiện đánh giá\u0027\n      WHEN rating \u003d 6 THEN \u0027No pay - base rate\u0027\n      WHEN rating \u003d 7 THEN \u0027No show\u0027\n    ELSE\n    \u0027Khác\u0027\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_rating(rating INT64)\nAS (\nCASE\n      WHEN (rating \u003d 0 or rating is null) THEN \u0027Chưa đánh giá\u0027\n      WHEN rating \u003d 1 THEN \u0027Không đạt\u0027\n      WHEN rating \u003d 2 THEN \u0027Đạt\u0027\n      WHEN rating \u003d 3 THEN \u0027Lớp dưới chuẩn\u0027\n      WHEN rating \u003d 4 THEN \u0027Lớp No pay\u0027\n      WHEN rating \u003d 5 THEN \u0027Chưa đủ điều kiện đánh giá\u0027\n      WHEN rating \u003d 6 THEN \u0027No pay - base rate\u0027\n      WHEN rating \u003d 7 THEN \u0027No show\u0027\n    ELSE\n    \u0027Khác\u0027\n  END\n);",
  "arguments": "rating (INT64)"
}, {
  "routine_name": "func_get_email_from_user",
  "routine_definition": "(\r\n   SELECT\r\n      MAX(u.email)\r\n    FROM\r\n    `kynaforkids-server-production.kynaforkids.user` u\r\n    WHERE u.id \u003d param_id\r\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_email_from_user(param_id INT64)\nAS (\n(\r\n   SELECT\r\n      MAX(u.email)\r\n    FROM\r\n    `kynaforkids-server-production.kynaforkids.user` u\r\n    WHERE u.id \u003d param_id\r\n  )\n);",
  "arguments": "param_id (INT64)"
}, {
  "routine_name": "func_get_country_affiliate",
  "routine_definition": "CASE\r\n  WHEN country_id \u003d 1  THEN \u0027Thailand\u0027\r\n  WHEN country_id \u003d 2  THEN \u0027Indo\u0027\r\n  WHEN country_id \u003d 3  THEN \u0027Việt Nam\u0027\r\n  WHEN country_id \u003d 4  THEN \u0027Khác\u0027\r\n  WHEN country_id \u003d 5  THEN \u0027Lào\u0027\r\n  WHEN country_id \u003d 6  THEN \u0027Malaysia\u0027\r\nELSE null\r\nEND",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_country_affiliate(country_id INT64)\nAS (\nCASE\r\n  WHEN country_id \u003d 1  THEN \u0027Thailand\u0027\r\n  WHEN country_id \u003d 2  THEN \u0027Indo\u0027\r\n  WHEN country_id \u003d 3  THEN \u0027Việt Nam\u0027\r\n  WHEN country_id \u003d 4  THEN \u0027Khác\u0027\r\n  WHEN country_id \u003d 5  THEN \u0027Lào\u0027\r\n  WHEN country_id \u003d 6  THEN \u0027Malaysia\u0027\r\nELSE null\r\nEND\n);",
  "arguments": "country_id (INT64)"
}, {
  "routine_name": "func_get_card_type_teacher",
  "routine_definition": "CASE\n  WHEN card_type \u003d 1 then \u0027ID\u0027\n  WHEN card_type \u003d 2 then \u0027Passport\u0027\nEND",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_card_type_teacher(card_type INT64)\nAS (\nCASE\n  WHEN card_type \u003d 1 then \u0027ID\u0027\n  WHEN card_type \u003d 2 then \u0027Passport\u0027\nEND\n);",
  "arguments": "card_type (INT64)"
}, {
  "routine_name": "func_get_booking_lead_source",
  "routine_definition": "CASE\n      WHEN source \u003d 1 THEN \u0027Marketing\u0027\n      WHEN source \u003d 2 THEN \u0027Sales\u0027\n      WHEN source \u003d 3 THEN \u0027Business development\u0027\n      WHEN source \u003d 4 THEN \u0027Other data\u0027\n    ELSE\n    \u0027Khác\u0027\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_lead_source(source INT64)\nAS (\nCASE\n      WHEN source \u003d 1 THEN \u0027Marketing\u0027\n      WHEN source \u003d 2 THEN \u0027Sales\u0027\n      WHEN source \u003d 3 THEN \u0027Business development\u0027\n      WHEN source \u003d 4 THEN \u0027Other data\u0027\n    ELSE\n    \u0027Khác\u0027\n  END\n);",
  "arguments": "source (INT64)"
}, {
  "routine_name": "func_get_country_gv",
  "routine_definition": "CASE\n  WHEN country_id \u003d 1  THEN \u0027100% PHIL\u0027\n  WHEN country_id \u003d 2  THEN \u0027100% NATIVE\u0027\n  WHEN country_id \u003d 3  THEN \u00272 PHIL/1 VN\u0027\n  WHEN country_id \u003d 4  THEN \u00272 NATIVE/1 VN\u0027\n  WHEN country_id \u003d 5  THEN \u0027100% VN\u0027\n  WHEN country_id \u003d 6  THEN \u0027100% THAILAND\u0027\n  WHEN country_id \u003d 7  THEN \u0027CUSTOM\u0027\n  WHEN country_id \u003d 8  THEN \u0027100% INDONESIA\u0027\n  WHEN country_id \u003d 9  THEN \u00271 PHIL/1 VN\u0027\n  WHEN country_id \u003d 10 THEN \u00271 NATIVE/1 VN\u0027\n  WHEN country_id \u003d 11 THEN \u00271 NATIVE/1 PHIL\u0027\n  WHEN country_id \u003d 12 THEN \u00272 PHIL/1 NATIVE\u0027\n  WHEN country_id \u003d 13 THEN \u00272 NATIVE/1 PHIL\u0027\n  WHEN country_id \u003d 14 THEN \u00272 VN/1 PHIL\u0027\n  WHEN country_id \u003d 15 THEN \u00272 VN/1 NATIVE\u0027\n  WHEN country_id \u003d 16 THEN \u00271 PHIL/1 THAI\u0027\n  WHEN country_id \u003d 17 THEN \u00271 NATIVE/1 THAI\u0027\n  WHEN country_id \u003d 18 THEN \u00272 PHIL/1 THAI\u0027\n  WHEN country_id \u003d 19 THEN \u00272 NATIVE/1 THAI\u0027\n  WHEN country_id \u003d 20 THEN \u00271 PHIL/1 INDO\u0027\n  WHEN country_id \u003d 21 THEN \u00271 NATIVE/1 INDO\u0027\n  WHEN country_id \u003d 22 THEN \u00272 PHIL/1 INDO\u0027\n  WHEN country_id \u003d 23 THEN \u00272 NATIVE/1 INDO\u0027\n  WHEN country_id \u003d 24 THEN \u0027100% LAOS\u0027\n  WHEN country_id \u003d 25 THEN \u00271 PHIL/1 LAOS\u0027\n  WHEN country_id \u003d 26 THEN \u00271 NATIVE/1 LAOS\u0027\n  WHEN country_id \u003d 27 THEN \u00272 PHIL/1 LAOS\u0027\n  WHEN country_id \u003d 28 THEN \u00272 NATIVE/1 LAOS\u0027\n  WHEN country_id \u003d 29 THEN \u0027100% MALAYSIA\u0027\n  WHEN country_id \u003d 30 THEN \u00271 PHIL/1 MALAY\u0027\n  WHEN country_id \u003d 31 THEN \u00271 NATIVE/1 MALAY\u0027\n  WHEN country_id \u003d 32 THEN \u00272 PHIL/1 MALAY\u0027\n  WHEN country_id \u003d 33 THEN \u00272 NATIVE/1 MALAY\u0027\nELSE \u0027Other countries\u0027\nEND",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_country_gv(country_id INT64)\nAS (\nCASE\n  WHEN country_id \u003d 1  THEN \u0027100% PHIL\u0027\n  WHEN country_id \u003d 2  THEN \u0027100% NATIVE\u0027\n  WHEN country_id \u003d 3  THEN \u00272 PHIL/1 VN\u0027\n  WHEN country_id \u003d 4  THEN \u00272 NATIVE/1 VN\u0027\n  WHEN country_id \u003d 5  THEN \u0027100% VN\u0027\n  WHEN country_id \u003d 6  THEN \u0027100% THAILAND\u0027\n  WHEN country_id \u003d 7  THEN \u0027CUSTOM\u0027\n  WHEN country_id \u003d 8  THEN \u0027100% INDONESIA\u0027\n  WHEN country_id \u003d 9  THEN \u00271 PHIL/1 VN\u0027\n  WHEN country_id \u003d 10 THEN \u00271 NATIVE/1 VN\u0027\n  WHEN country_id \u003d 11 THEN \u00271 NATIVE/1 PHIL\u0027\n  WHEN country_id \u003d 12 THEN \u00272 PHIL/1 NATIVE\u0027\n  WHEN country_id \u003d 13 THEN \u00272 NATIVE/1 PHIL\u0027\n  WHEN country_id \u003d 14 THEN \u00272 VN/1 PHIL\u0027\n  WHEN country_id \u003d 15 THEN \u00272 VN/1 NATIVE\u0027\n  WHEN country_id \u003d 16 THEN \u00271 PHIL/1 THAI\u0027\n  WHEN country_id \u003d 17 THEN \u00271 NATIVE/1 THAI\u0027\n  WHEN country_id \u003d 18 THEN \u00272 PHIL/1 THAI\u0027\n  WHEN country_id \u003d 19 THEN \u00272 NATIVE/1 THAI\u0027\n  WHEN country_id \u003d 20 THEN \u00271 PHIL/1 INDO\u0027\n  WHEN country_id \u003d 21 THEN \u00271 NATIVE/1 INDO\u0027\n  WHEN country_id \u003d 22 THEN \u00272 PHIL/1 INDO\u0027\n  WHEN country_id \u003d 23 THEN \u00272 NATIVE/1 INDO\u0027\n  WHEN country_id \u003d 24 THEN \u0027100% LAOS\u0027\n  WHEN country_id \u003d 25 THEN \u00271 PHIL/1 LAOS\u0027\n  WHEN country_id \u003d 26 THEN \u00271 NATIVE/1 LAOS\u0027\n  WHEN country_id \u003d 27 THEN \u00272 PHIL/1 LAOS\u0027\n  WHEN country_id \u003d 28 THEN \u00272 NATIVE/1 LAOS\u0027\n  WHEN country_id \u003d 29 THEN \u0027100% MALAYSIA\u0027\n  WHEN country_id \u003d 30 THEN \u00271 PHIL/1 MALAY\u0027\n  WHEN country_id \u003d 31 THEN \u00271 NATIVE/1 MALAY\u0027\n  WHEN country_id \u003d 32 THEN \u00272 PHIL/1 MALAY\u0027\n  WHEN country_id \u003d 33 THEN \u00272 NATIVE/1 MALAY\u0027\nELSE \u0027Other countries\u0027\nEND\n);",
  "arguments": "country_id (INT64)"
}, {
  "routine_name": "func_get_booking_payment_status",
  "routine_definition": "CASE\n      WHEN payment_status \u003d 0 THEN \u0027Chờ duyệt\u0027\n      WHEN payment_status \u003d 1 THEN \u0027Đã Duyệt\u0027\n      WHEN payment_status \u003d 2 THEN \u0027Không duyệt\u0027\n      when payment_status \u003d 3 then \u0027Cần điều chỉnh\u0027\n      when payment_status \u003d 4 then \u0027Đã điều chỉnh\u0027\n    ELSE\n    \u0027Khác\u0027\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_booking_payment_status(payment_status INT64)\nAS (\nCASE\n      WHEN payment_status \u003d 0 THEN \u0027Chờ duyệt\u0027\n      WHEN payment_status \u003d 1 THEN \u0027Đã Duyệt\u0027\n      WHEN payment_status \u003d 2 THEN \u0027Không duyệt\u0027\n      when payment_status \u003d 3 then \u0027Cần điều chỉnh\u0027\n      when payment_status \u003d 4 then \u0027Đã điều chỉnh\u0027\n    ELSE\n    \u0027Khác\u0027\n  END\n);",
  "arguments": "payment_status (INT64)"
}, {
  "routine_name": "func_get_student_name_from_profile_by_student_id",
  "routine_definition": "(\r\n   SELECT\r\n      max(p.name)\r\n    FROM\r\n    `kynaforkids-server-production.kynaforkids.profile` p\r\n    where p.user_id \u003d student_id\r\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_student_name_from_profile_by_student_id(student_id INT64)\nAS (\n(\r\n   SELECT\r\n      max(p.name)\r\n    FROM\r\n    `kynaforkids-server-production.kynaforkids.profile` p\r\n    where p.user_id \u003d student_id\r\n  )\n);",
  "arguments": "student_id (INT64)"
}, {
  "routine_name": "func_get_email_from_kynaforkids_user",
  "routine_definition": "(\r\n   SELECT\r\n      MAX(u.email)\r\n    FROM\r\n    `kynaforkids-server-production.kynaforkids.user` u\r\n    WHERE u.id \u003d param_id\r\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_email_from_kynaforkids_user(param_id INT64)\nAS (\n(\r\n   SELECT\r\n      MAX(u.email)\r\n    FROM\r\n    `kynaforkids-server-production.kynaforkids.user` u\r\n    WHERE u.id \u003d param_id\r\n  )\n);",
  "arguments": "param_id (INT64)"
}, {
  "routine_name": "func_get_teacher_tags",
  "routine_definition": "CASE\n      WHEN tags \u003d \u00271\u0027 THEN \u0027Native accent\u0027\n      WHEN tags \u003d \u00272\u0027 THEN \u0027Nice and friendly\u0027\n      WHEN tags \u003d \u00273\u0027 THEN \u0027Strict\u0027\n      WHEN tags \u003d \u00274\u0027 THEN \u0027Suitable for kindergarten children\u0027\n      WHEN tags \u003d \u00275\u0027 THEN \u0027Use rewards and gamification\u0027    \n      WHEN tags \u003d \u00276\u0027 THEN \u0027Đã nghỉ\u0027 \n      WHEN tags \u003d \u00277\u0027 THEN \u0027Du học sinh\u0027\n      WHEN tags \u003d \u00278\u0027 THEN \u0027Kinh nghiệm dưới 2 năm\u0027\n      WHEN tags \u003d \u00279\u0027 THEN \u0027Kinh nghiệm từ 2-5 năm\u0027\n      WHEN tags \u003d \u002710\u0027 THEN \u0027Kinh nghiệm trên 5 năm\u0027  \n      WHEN tags \u003d \u002711\u0027 THEN \u0027Ưa nhìn, cười đẹp\u0027\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_teacher_tags(tags STRING)\nAS (\nCASE\n      WHEN tags \u003d \u00271\u0027 THEN \u0027Native accent\u0027\n      WHEN tags \u003d \u00272\u0027 THEN \u0027Nice and friendly\u0027\n      WHEN tags \u003d \u00273\u0027 THEN \u0027Strict\u0027\n      WHEN tags \u003d \u00274\u0027 THEN \u0027Suitable for kindergarten children\u0027\n      WHEN tags \u003d \u00275\u0027 THEN \u0027Use rewards and gamification\u0027    \n      WHEN tags \u003d \u00276\u0027 THEN \u0027Đã nghỉ\u0027 \n      WHEN tags \u003d \u00277\u0027 THEN \u0027Du học sinh\u0027\n      WHEN tags \u003d \u00278\u0027 THEN \u0027Kinh nghiệm dưới 2 năm\u0027\n      WHEN tags \u003d \u00279\u0027 THEN \u0027Kinh nghiệm từ 2-5 năm\u0027\n      WHEN tags \u003d \u002710\u0027 THEN \u0027Kinh nghiệm trên 5 năm\u0027  \n      WHEN tags \u003d \u002711\u0027 THEN \u0027Ưa nhìn, cười đẹp\u0027\n  END\n);",
  "arguments": "tags (STRING)"
}, {
  "routine_name": "func_get_class_status",
  "routine_definition": "(\n  CASE\n    WHEN status \u003d 1 THEN \u0027Mới tạo\u0027\n    WHEN status \u003d 2 THEN \u0027Đang học\u0027\n    WHEN status \u003d 3 THEN \u0027Lớp chuẩn bị hoàn thành\u0027\n    WHEN status \u003d 4 THEN \u0027Hoàn thành\u0027\n    WHEN status \u003d 5 THEN \u0027Huỷ\u0027\n    ELSE \u0027Không có lớp\u0027\n  END\n  )",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_class_status(status INT64)\nAS (\n(\n  CASE\n    WHEN status \u003d 1 THEN \u0027Mới tạo\u0027\n    WHEN status \u003d 2 THEN \u0027Đang học\u0027\n    WHEN status \u003d 3 THEN \u0027Lớp chuẩn bị hoàn thành\u0027\n    WHEN status \u003d 4 THEN \u0027Hoàn thành\u0027\n    WHEN status \u003d 5 THEN \u0027Huỷ\u0027\n    ELSE \u0027Không có lớp\u0027\n  END\n  )\n);",
  "arguments": "status (INT64)"
}, {
  "routine_name": "func_get_country",
  "routine_definition": "CASE\n      WHEN country_id \u003d 1 THEN \u0027Thailand\u0027\n      WHEN country_id \u003d 2 THEN \u0027Indo\u0027\n      WHEN country_id \u003d 3 THEN \u0027Việt Nam\u0027\n      WHEN country_id \u003d 4 THEN \u0027Khác\u0027\n      WHEN country_id \u003d 5 THEN \u0027Lào\u0027\n      WHEN country_id \u003d 6 THEN \u0027Malaysia\u0027\n    ELSE\n    \u0027Khác\u0027\n  END",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_country(country_id INT64)\nAS (\nCASE\n      WHEN country_id \u003d 1 THEN \u0027Thailand\u0027\n      WHEN country_id \u003d 2 THEN \u0027Indo\u0027\n      WHEN country_id \u003d 3 THEN \u0027Việt Nam\u0027\n      WHEN country_id \u003d 4 THEN \u0027Khác\u0027\n      WHEN country_id \u003d 5 THEN \u0027Lào\u0027\n      WHEN country_id \u003d 6 THEN \u0027Malaysia\u0027\n    ELSE\n    \u0027Khác\u0027\n  END\n);",
  "arguments": "country_id (INT64)"
}, {
  "routine_name": "func_get_user_name",
  "routine_definition": "(\n    SELECT\n      max(p.name)\n    FROM\n      `kynaforkids-server-production.kynaforkids.profile` p\n    WHERE\n      p.user_id\u003duser_id)",
  "ddl": "CREATE FUNCTION `kynaforkids-server-production`.kynaforkids.func_get_user_name(user_id INT64)\nAS (\n(\n    SELECT\n      max(p.name)\n    FROM\n      `kynaforkids-server-production.kynaforkids.profile` p\n    WHERE\n      p.user_id\u003duser_id)\n);",
  "arguments": "user_id (INT64)"
}]